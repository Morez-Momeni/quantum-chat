<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Three Musketeers + 1 chat</title>
    <link rel="stylesheet" href="/static/style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <canvas id="bg-canvas"></canvas>
    <div class="container">
        <h1 class="title-3d">Three Musketeers + 1</h1>
        <p class="subtitle-glow">یکی رو انتخاب کن تا وارد بشی</p>
        <div class="friends-orbit">
            {% for friend in friends %}
            <div class="friend-card-3d" onclick="goToLogin('{{ friend }}')" style="--delay: {{ loop.index * 0.1 }}s">
                <div class="card-inner">
                    <span class="name">{{ friend }}</span>
                    <div class="glow"></div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vanilla-tilt@1.7.0/dist/vanilla-tilt.min.js"></script>
    <script>
        const canvas = document.getElementById('bg-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        const particles = [];
        const colors = ['#00d4ff', '#ff2e63', '#7c3aed', '#10b981'];
        for (let i = 0; i < 80; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                radius: Math.random() * 2 + 1,
                speed: Math.random() * 1 + 0.5,
                angle: Math.random() * Math.PI * 2,
                color: colors[i % 4]
            });
        }
        function animateBg() {
            ctx.fillStyle = 'rgba(10, 10, 30, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => {
                p.x += Math.cos(p.angle) * p.speed;
                p.y += Math.sin(p.angle) * p.speed;
                if (p.x < 0 || p.x > canvas.width) p.angle = Math.PI - p.angle;
                if (p.y < 0 || p.y > canvas.height) p.angle = -p.angle;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
                ctx.fillStyle = p.color + '40';
                ctx.fill();
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.radius * 0.5, 0, Math.PI * 2);
                ctx.fillStyle = p.color;
                ctx.fill();
            });
            requestAnimationFrame(animateBg);
        }
        animateBg();
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
        VanillaTilt.init(document.querySelectorAll(".friend-card-3d"), {
            max: 15, speed: 400, glare: true, "max-glare": 0.3
        });
        function goToLogin(username) {
            window.location.href = `/login/${encodeURIComponent(username)}`;
        }
    </script>
</body>

</html>
